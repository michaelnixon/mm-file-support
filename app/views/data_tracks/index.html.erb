<% provide(:title, 'Accessible Tracks') %>
<h1>Data Track Browser</h1>

<table class="table table-striped table-bordered" id="mytracks">
  <thead>
    <tr>
      <th>Name</th>
      <th>Take</th>
			<th>Project</th>
	  	<th>Sensors</th>
			<th>Movers</th>
	  	<th>Technician</th>
			<th>Recording Date</th>
	  	<th>Tags</th>
    </tr>
  </thead>

  <tbody>
    <% @data_tracks.each do |track| %>
      <tr>
        <td><%= link_to truncate(track.name, length: 40), data_track_path(track) %> <%= render partial: "owner_options", locals: { track: track} if authorized?(track)%></td>
				<td>
					<% if !track.take.nil? and (track.take.public? or track.take.is_accessible_by?(@current_user)) %>
						<%= link_to truncate(track.take.name, length: 25), take_path(track.take) %><span style="float:right">
						<%= link_to 'Mova!', mova_url + "take_id=#{track.take.id}&track_id=#{track.id}"%></span>
					<% else %>
						<%= truncate(track.take.name, length: 25)%>
					<% end %>
				</td>
				<td>
					<% if track.take and (track.take.movement_group.project.public? or track.take.movement_group.project.is_accessible_by?(@current_user)) %>
						<%= link_to truncate(track.take.movement_group.project.name, length: 25), project_path(track.take.movement_group.project) %>
					<% else %>
						<%= truncate(track.take.movement_group.project.name, length: 25)%>
					<% end %>					
				</td>
				<td><%= raw(track.sensor_types.map{|type| link_to(type.name, sensor_type_path(type)) }.join(", "))%></td>
				<td><%= raw(track.movers.map{|mover| link_to(mover.name, mover_path(mover)) }.join(", ")) %></td>
				<td><%= truncate(track.technician, length: 20) %></td>
				<td><%= track.recorded_on %></td>
				<td><%= track.tag_list %></td>
      </tr>
    <% end %>
  </tbody>
</table>
